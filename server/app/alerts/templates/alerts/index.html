{% extends "base.html" %}
{% load static %}

{% block title %}Dashboard{% endblock %}

{% block header %}
    <link rel="stylesheet" href="{% static 'alerts/style.css' %}">
    <script src="{% static 'js/api.js' %}"></script>
    <script src="{% static 'alerts/script.js' %}" defer></script>
{% endblock %}
{% block content %}
    <form class="card search" action="#">
        <div class="field">
            <label for="search"><iconify-icon icon="fluent:search-32-filled"></iconify-icon></label>
            <input class="field-input" name="type" id="search" type="text" placeholder="Rechercher ...">
        </div>
        <div class="field">
            <input class="field-input" name="start_date" id="start-date" type="datetime-local" placeholder="Début">
        </div>
        <div class="field">
            <input class="field-input" name="end_date" id="end-date" type="datetime-local" placeholder="Fin">
        </div>

        <div class="field dropdown">
            <button class="dropdown-button">
                Vérification
                <iconify-icon icon="fluent:chevron-down-32-filled"></iconify-icon>
            </button>
            <div class="dropdown-content">
                <div class="dropdown-category">Local</div>
                <label for="yara">Yara</label>
                <input type="checkbox" name="source" id="yara" value="local_yara">
                <br>
                <label for="suricate">Suricata</label>
                <input type="checkbox" name="source" id="suricate" value="local_suricata">
                <br>
                <label for="snort">Snort</label>
                <input type="checkbox" name="source" id="snort" value="local_snort">

                <div class="dropdown-category">Cloud</div>
                <label for="virus-total">Virus Total</label>
                <input type="checkbox" name="source" id="virus-total" value="online_virustotal">
                <label for="IPDB">IPDB</label>
                <input type="checkbox" name="source" id="IPDB" value="online_abuseIPDB">

                <div class="dropdown-category">IA</div>
                <label for="IA-1">IA Random Forest</label>
                <input type="checkbox" name="source" id="IA-1" value="ia_random_forest">
                <label for="IA-2">IA SVM</label>
                <input type="checkbox" name="source" id="IA-2" value="ia_support_vector_machine">
            </div>
        </div>

        <button type="submit">
            <iconify-icon icon="fluent:checkmark-32-regular" width="32" height="32"></iconify-icon>
        </button>

        <button type="button" class="align-right inverted">
            <iconify-icon icon="fluent:document-text-32-regular"></iconify-icon> Générer un rapport
        </button>
    </form>

    <div class="card" id="alerts">
        <h2>Alertes</h2>
        <hr>
        <table class="table">
            <thead>
            <tr>
                <th class="align-left" scope="col">Time</th>
                <th scope="col">Agent</th>
                <th scope="col">Agent Name</th>
                <th scope="col">Detection</th>
                <th scope="col">Tactic</th>
                <th scope="col">Description</th>
                <th scope="col">Level</th>
                <th scope="col">ID</th>
            </tr>
            </thead>
            <tbody>
            </tbody>
        </table>
    </div>
{% endblock %}